<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NPRI Facilities Map - Canada</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <link rel="stylesheet" href="styles/style.css">
</head>
<body>
    <div class="header">
        <h1>NPRI Facilities Across Canada</h1>
        <p>Mapping environmental reporting facilities from the National Pollutant Release Inventory</p>
    </div>
    
    <div id="map"></div>
    
    <div class="sidebar">
        <div class="controls">
            <h3>Filters</h3>
            <select id="provinceFilter">
                <option value="">All Provinces</option>
            </select>
            <select id="sectorFilter">
                <option value="">All Sectors</option>
            </select>
            <input type="number" id="yearFilter" placeholder="Report Year" min="2010" max="2024">
            <button onclick="applyFilters()">Apply Filters</button>
            <button onclick="resetFilters()">Reset</button>
        </div>
        <div class="info-panel">
            <h3>Facility Information</h3>
            <div id="facilityInfo">Click on a facility to see details</div>
        </div>
    </div>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="scripts/map.js"></script>
    <!-- simplified version - add this to your existing HTML -->
    <script>
    // Add this to your current GitHub HTML file
    const map = L.map('map').setView([56.130, -106.35], 4);
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png').addTo(map);
    
    // Fetch NPRI data directly
    fetch('https://maps-cartes.ec.gc.ca/arcgis/rest/services/STB_DGST/NPRI/MapServer/0/query?where=1=1&outFields=*&returnGeometry=true&f=geojson&outSR=4326')
        .then(response => response.json())
        .then(data => {
            data.features.forEach(feature => {
                if (feature.geometry && feature.geometry.type === 'Point') {
                    const [lng, lat] = feature.geometry.coordinates;
                    L.marker([lat, lng])
                        .bindPopup(`<b>${feature.properties.CompanyName}</b><br>${feature.properties.FacilityName}`)
                        .addTo(map);
                }
            });
        });
    </script>
</body>
</html>
